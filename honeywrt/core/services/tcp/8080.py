class tcp8080(Protocol):
	def connectionMade(self):
		logprint("[honeypot.HoneyPotFactory] New connection: %s:%s (%s:%s) [Session: %d]" % \
		(self.transport.getPeer().host, self.transport.getPeer().port, self.transport.getHost().host, self.transport.getHost().port, self.transport.sessionno))
	def dataReceived(self, data):
		if data[:20] == binascii.unhexlify('474554202f484e4150312f20485454502f312e31'): # GET /HNAP1/ HTTP/1.1
			logprint("[HoneyPotTransport.HTTPPROXY,%s,%s] Requested Page HNAP1" % (self.transport.sessionno, self.transport.getPeer().host))
			self.transport.loseConnection()
		if data[:22] == binascii.unhexlify('474554202F6D616E616765722F68746D6C2048545450'): # Get /manager/html
			logprint("[HoneyPotTransport.TOMCAT,%s,%s] Sending Admin Login" % (self.transport.sessionno, self.transport.getPeer().host))
			self.transport.write(binascii.unhexlify('\
485454502f312e312034303120556e617574686f72697a65640d0a5365727665723a204170616368652d436f796f74652f312e310d0a43616368652d436f6e74726f6c3a20707269766174650d0a4578\
70697265733a205468752c203031204a616e20313937302030303a30303a3030205554430d0a5757572d41757468656e7469636174653a204261736963207265616c6d3d22546f6d636174204d616e61\
676572204170706c69636174696f6e220d0a5365742d436f6f6b69653a204a53455353494f4e49443d32464231383138313431454432443132434546324144444344464535423137433b20506174683d\
2f6d616e616765722f3b20487474704f6e6c790d0a436f6e74656e742d547970653a20746578742f68746d6c3b636861727365743d49534f2d383835392d310d0a5472616e736665722d456e636f6469\
6e673a206368756e6b65640d0a446174653a205468752c203234204a756c20323031342032323a33353a343720474d540d0a0d0a3961610d0a0a3c21444f43545950452068746d6c205055424c494320\
222d2f2f5733432f2f4454442048544d4c20342e30312f2f454e222022687474703a2f2f7777772e77332e6f72672f54522f68746d6c342f7374726963742e647464223e0a3c68746d6c3e0a203c6865\
61643e0a20203c7469746c653e34303120556e617574686f72697a65643c2f7469746c653e0a20203c7374796c6520747970653d22746578742f637373223e0a202020203c212d2d0a20202020424f44\
59207b666f6e742d66616d696c793a5461686f6d612c417269616c2c73616e732d73657269663b636f6c6f723a626c61636b3b6261636b67726f756e642d636f6c6f723a77686974653b666f6e742d73\
697a653a313270783b7d0a202020204831207b666f6e742d66616d696c793a5461686f6d612c417269616c2c73616e732d73657269663b636f6c6f723a77686974653b6261636b67726f756e642d636f\
6c6f723a233532354437363b666f6e742d73697a653a323270783b7d0a202020205052452c205454207b626f726465723a2031707820646f7474656420233532354437367d0a2020202041207b636f6c\
6f72203a20626c61636b3b7d412e6e616d65207b636f6c6f72203a20626c61636b3b7d0a202020202d2d3e0a20203c2f7374796c653e0a203c2f686561643e0a203c626f64793e0a2020203c68313e34\
303120556e617574686f72697a65643c2f68313e0a2020203c703e0a20202020596f7520617265206e6f7420617574686f72697a656420746f2076696577207468697320706167652e20496620796f75\
2068617665206e6f74206368616e6765640a20202020616e7920636f6e66696775726174696f6e2066696c65732c20706c65617365206578616d696e65207468652066696c650a202020203c74743e63\
6f6e662f746f6d6361742d75736572732e786d6c3c2f74743e20696e20796f757220696e7374616c6c6174696f6e2e20546861740a2020202066696c65206d75737420636f6e7461696e207468652063\
726564656e7469616c7320746f206c657420796f75207573652074686973207765626170702e0a2020203c2f703e0a2020203c703e0a20202020466f72206578616d706c652c20746f20616464207468\
65203c74743e6d616e616765722d6775693c2f74743e20726f6c6520746f20612075736572206e616d65640a202020203c74743e746f6d6361743c2f74743e207769746820612070617373776f726420\
6f66203c74743e7333637265743c2f74743e2c206164642074686520666f6c6c6f77696e6720746f207468650a20202020636f6e6669672066696c65206c69737465642061626f76652e0a2020203c2f\
703e0a3c7072653e0a266c743b726f6c6520726f6c656e616d653d226d616e616765722d677569222f2667743b0a266c743b7573657220757365726e616d653d22746f6d636174222070617373776f72\
643d227333637265742220726f6c65733d226d616e616765722d677569222f2667743b0a3c2f7072653e0a2020203c703e0a202020204e6f7465207468617420666f7220546f6d6361742037206f6e77\
617264732c2074686520726f6c657320726571756972656420746f2075736520746865206d616e616765720a202020206170706c69636174696f6e2077657265206368616e6765642066726f6d207468\
652073696e676c65203c74743e6d616e616765723c2f74743e20726f6c6520746f207468650a20202020666f6c6c6f77696e6720666f757220726f6c65732e20596f752077696c6c206e65656420746f\
2061737369676e2074686520726f6c6528732920726571756972656420666f720a202020207468652066756e6374696f6e616c69747920796f75207769736820746f206163636573732e0a2020203c2f\
703e0a202020203c756c3e0a2020202020203c6c693e3c74743e6d616e616765722d6775693c2f74743e202d20616c6c6f77732061636365737320746f207468652048544d4c2047554920616e642074\
6865207374617475730a2020202020202020202070616765733c2f6c693e0a2020202020203c6c693e3c74743e6d616e616765722d7363726970743c2f74743e202d20616c6c6f777320616363657373\
20746f20746865207465787420696e7465726661636520616e64207468650a202020202020202020207374617475732070616765733c2f6c693e0a2020202020203c6c693e3c74743e6d616e61676572\
2d6a6d783c2f74743e202d20616c6c6f77732061636365737320746f20746865204a4d582070726f787920616e6420746865207374617475730a2020202020202020202070616765733c2f6c693e0a20\
20202020203c6c693e3c74743e6d616e616765722d7374617475733c2f74743e202d20616c6c6f77732061636365737320746f2074686520737461747573207061676573206f6e6c793c2f6c693e0a20\
2020203c2f756c3e0a2020203c703e0a202020205468652048544d4c20696e746572666163652069732070726f74656374656420616761696e737420435352462062757420746865207465787420616e\
64204a4d5820696e74657266616365730a20202020617265206e6f742e20546f206d61696e7461696e2074686520435352462070726f74656374696f6e3a0a2020203c2f703e0a2020203c756c3e0a20\
2020203c6c693e5573657273207769746820746865203c74743e6d616e616765722d6775693c2f74743e20726f6c652073686f756c64206e6f74206265206772616e746564206569746865720a202020\
2020202020746865203c74743e6d616e616765722d7363726970743c2f74743e206f72203c74743e6d616e616765722d6a6d783c2f74743e20726f6c65732e3c2f6c693e0a202020203c6c693e496620\
7468652074657874206f72206a6d7820696e746572666163657320617265206163636573736564207468726f75676820612062726f777365722028652e672e20666f720a202020202020202074657374\
696e672073696e636520746865736520696e74657266616365732061726520696e74656e64656420666f7220746f6f6c73206e6f742068756d616e7329207468656e0a20202020202020207468652062\
726f77736572206d75737420626520636c6f736564206166746572776172647320746f207465726d696e617465207468652073657373696f6e2e3c2f6c693e0a2020203c2f756c3e0a2020203c703e0a\
20202020466f72206d6f726520696e666f726d6174696f6e202d20706c6561736520736565207468650a202020203c6120687265663d222f646f63732f6d616e616765722d686f77746f2e68746d6c22\
3e4d616e616765722041707020484f572d544f3c2f613e2e0a2020203c2f703e0a203c2f626f64793e0a0a3c2f68746d6c3e0a0d0a300d0a0d0a'))
			self.transport.loseConnection()
	def connectionLost(self, reason):
		self.state = 0

f = Factory()
f.protocol = tcp8080
